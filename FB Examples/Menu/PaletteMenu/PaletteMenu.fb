include "NSLog.incl"_mColors = 1begin enum_iColorsend enum_pmColors = 101begin enum_iRed_iGren_iBlueend enum// popup menubegin enum_iCarsend enum_pmCars = 102begin enum_iCyan_iMagenta_iYellow_iBlackend enum_window = 1begin enum 1_popupBtnend enumvoid local fn BuildMenumenu _mColors,,, @"Colors"menu _mColors, _iColors,, @"Colors"palettemenu _pmColors, @[fn ColorRed,fn ColorGreen,fn ColorBlue], @[@"Red",@"Green",@"Blue"]MenuItemSetState( _pmColors, _iRed, NSControlStateValueOn )MenuSetSubmenu( _mColors, _iColors, _pmColors )end fnvoid local fn BuildWindowwindow _windowpopupbutton _popupBtn,,, @"Cars", (200,200,120,25)CFArrayRef colors = @[fn ColorOrange,fn ColorMagenta,fn ColorYellow,fn ColorBlack]CFArrayRef titles = @[@"Orange",@"Magenta",@"Yellow",@"Black"]ImageRef image = fn ImageWithSystemSymbolName( @"car.fill", NULL )palettemenu _pmCars, colors, titles, image, NSMenuSelectionModeSelectOneMenuSetSubmenu( fn PopUpButtonMenu( _popupBtn ), _iCars, _pmCars )end fnvoid local fn DoMenu( menuID as long, itemID as long )NSLog(@"%@ - %@",fn MenuTitle(menuID),fn MenuItemTitle(menuID,itemID))end fnfn BuildMenufn BuildWindowon menu fn DoMenuHandleEvents