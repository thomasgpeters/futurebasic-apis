/*  Demonstrates ViewSetNeedsDisplay in CGGraphics  Written by S.Van Voorst   {20171007}*/_window = 100_wndW = 600_wndH = 600begin enum 1_sliderBtn_sliderValue_cWell_dotView_quitBtnend enumvoid local fn ViewDrawRectCGRect   viewRect, dotRectCGContextRef ctx = fn GraphicsContextCurrentCGContextviewRect = fn ViewBounds( _dotView )long sliderValue = fn ControlIntegerValue( _sliderBtn )CGContextSaveGState( ctx )// ---- Background color ------ //CGContextSetRGBFillColor( ctx, 1.0, 1.0, 1.0, 1.0 )CGContextFillRect( ctx, viewRect )// ------ Frame ------ //CGContextSetLineWidth(ctx, 6.0)CGContextSetRGBStrokeColor( ctx, 0.0, 0.0, 0.0, 1.0  )CGContextStrokeRect( ctx, viewRect )// -------- Dot Size ------- //dotRect.origin.x = viewRect.size.width/2 - sliderValuedotRect.origin.y = viewRect.size.height/2 - sliderValuedotRect.size.width = 2 *  sliderValuedotRect.size.height = 2 *  sliderValue// -------- Dot Color ------- //ColorRef col = fn ColorWellColor(_cWell)CGColorRef myColor = fn ColorCGColor( col )CGContextSetFillColorWithColor( ctx, myColor )CGContextFillEllipseInRect( ctx, dotRect )CGContextRestoreGState( ctx )end fnvoid local fn BuildWindowwindow 1, @"DotView", ( 0, 0, _wndW, _wndH )superview view subclass _dotView, ( 0, 0, _wndH, _wndW)// **** Color Well **** //ColorRef myColor = fn ColorWithRGB( 1.0, 0.0, 0.0, 1.0 )colorwell _cWell,, myColor, ( 30, 30, 50, 30 )// **** Slider **** //slider _sliderBtn,,75, ( 170, 30, 250, 20 ), 0, 240ControlSetContinuous( _sliderBtn, YES )textlabel _sliderValue, @"75", ( 430, 35, 36, 17 )ControlSetAlignment( _sliderValue, NSTextAlignmentCenter )superviewend// **** Quit Btn **** //button _quitBtn, , , @"Q", (_wndW - 50, 10, 40, 40),, NSBezelStyleCircularControlSetAction( _quitBtn, @"terminate:" )end fnvoid local fn DoDialog( ev as long, tag as long )select ( ev )case _btnClickselect (tag)case _cWellViewSetNeedsDisplay(_dotView)case _sliderBtnControlTakeIntegerValueFrom( _sliderValue, _sliderBtn )ViewSetNeedsDisplay(_dotView)end selectcase _viewDrawRectselect ( tag )case _dotViewfn ViewDrawRectend selectend selectend fnfn BuildWindowon dialog fn DoDialogHandleEvents