/*  CALayer Demo*/include resources "Teacup.png"_window = 1begin enum 1_layerViewend enumlocal fn AddSublayer( superlayer as CALayerRef, frame as CGRect, bgCol as ColorRef, shOffset as CGSize, shRadius as CGFloat, shOpacity as float, image as ImageRef ) as CALayerRefCALayerRef sublayer = fn CALayerInitCALayerSetBackgroundColor( sublayer, bgCol )CALayerSetShadowOffset( sublayer, shOffset )CALayerSetShadowRadius( sublayer, shRadius )CALayerSetShadowOpacity( sublayer, shOpacity )CALayerSetContents( sublayer, image )CALayerSetFrame( sublayer, frame )CALayerAddSublayer( superlayer, sublayer )end fn = sublayervoid local fn AddViewLayers( tag as NSInteger )CALayerRef   layer, sublayer1, sublayer2, sublayer3, sublayer4, sublayer5layer = fn ViewLayer( tag )CALayerSetBackgroundColor( layer, fn ColorYellow )CALayerSetCornerRadius( layer, 50.0 )sublayer1 = fn AddSublayer( layer, fn CGRectMake(30,100,100,100), fn ColorRed, fn CGSizeMake(5,-5), 3.0, 0.5, fn ImageNamed(@"Teacup") )sublayer2 = fn AddSublayer( layer, fn CGRectMake(170,100,100,100), fn ColorGreen, fn CGSizeMake(5,-5), 3.0, 0.5, fn ImageNamed(@"Teacup") )sublayer3 = fn AddSublayer( layer, fn CGRectMake(310,100,100,100), fn ColorBlue, fn CGSizeMake(5,-5), 3.0, 0.5, fn ImageNamed(@"Teacup") )sublayer4 = fn AddSublayer( layer, fn CGRectMake(260,50,100,100), fn ColorCyan, fn CGSizeMake(5,-5), 3.0, 0.5, fn ImageNamed(@"Teacup") )sublayer5 = fn AddSublayer( layer, fn CGRectMake(120,50,100,100), fn ColorMagenta, fn CGSizeMake(5,-5), 3.0, 0.5, fn ImageNamed(@"Teacup") )CALayerInsertSublayerBelow( layer, sublayer4, sublayer3 )CALayerInsertSublayerBelow( layer, sublayer5, sublayer2 )end fnvoid local fn BuildWindowwindow _window, @"CALayer Demo", (0,0,550,350)view _layerView, (50,50,450,250)ViewSetWantsLayer( _layerView, YES )fn AddViewLayers( _layerView )end fnfn BuildWindowHandleEvents