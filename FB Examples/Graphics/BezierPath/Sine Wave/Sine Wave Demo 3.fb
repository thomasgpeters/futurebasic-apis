_window = 1begin enum 1_imagView_sinewaveViewend enumvoid local fn BuildWindowCGRect r = fn CGRectMake( 0, 0, 480, 360 )window _window, @"Sine Wave Demo 3", r, NSWindowStyleMaskTitled + NSWindowStyleMaskClosable + NSWindowStyleMaskMiniaturizabler = fn CGRectMake( 0, 100, 480, 260 )subclass view _sinewaveView, r, _windowend fnlocal fn SineWave ( tag as long )CGFloat             x, yCGFloat        amplitude = 110.0                                    // Amplitude of the sine waveCGFloat        frequency = 0.0268                                   // Frequency of the sine waveCGFloat            phase = 3.0                                      // Phase shiftBezierPathRef      path  = fn BezierPathInit                        // Create bezier curveCGFloat   verticalOffset = fn CGRectGetMidY( fn ViewBounds( tag ) ) // Center the wave verticallyCGFloat horizontalOffset = fn CGRectGetMinX( fn ViewBounds( tag ) ) // Start the wave from the leftBezierPathFillRect( fn ViewBounds( tag ), fn ColorBlack )BezierPathMoveToPoint( path, fn CGPointMake( horizontalOffset, verticalOffset ) ) // Set bezier path start pointfor x = horizontalOffset to fn CGRectGetMaxX( fn ViewBounds( tag ) ) -1           // Draw the sine wavey = amplitude * sin( frequency * ( x - horizontalOffset ) + phase ) + verticalOffsetBezierPathLineToPoint( path, fn CGPointMake( x, y ) )nextBezierPathStrokeFill( path, 2.0, fn ColorGreen, NULL )             // Set the stroke color and line width (no fill)end fnvoid local fn DoDialog( ev as long, tag as long, wnd as long, obj as CFTypeRef )select ( ev )case _viewDrawRectselect ( tag )case _sinewaveView : fn SineWave( tag )end selectcase _windowWillClose  : endend selectend fnon dialog fn DoDialogfn BuildWindowHandleEvents