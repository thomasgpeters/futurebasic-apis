_window = 1void local fn BuildWindowCGRect r = fn CGRectMake( 0, 0, 480, 360 )window _window, @"Sine Wave Demo 2", r, NSWindowStyleMaskTitled + NSWindowStyleMaskClosable + NSWindowStyleMaskMiniaturizableWindowSetBackgroundColor( _window, fn ColorBlack )WindowSubclassContentView( _window )end fnlocal fn SineWave( tag as long )CGFloat             x, yCGFloat        amplitude = 140.0                                     // Height of the waveCGFloat        frequency = 0.0268                                    // Frequency of the waveCGFloat            phase = 3.0                                       // Phase shiftBezierPathRef      path  = fn BezierPathInit                         // Create bezier pathCGFloat   verticalOffset = fn CGRectGetMidY( fn ViewBounds( tag ) )  // Center the wave verticallyCGFloat horizontalOffset = fn CGRectGetMinX( fn ViewBounds( tag ) )  // Start the wave from the leftBezierPathMoveToPoint( path, fn CGPointMake( horizontalOffset, verticalOffset ) )for x = horizontalOffset to fn CGRectGetMaxX( fn ViewBounds( tag ) ) -1  // Draw the sine wavey = amplitude * sin( frequency * ( x - horizontalOffset ) + phase ) + verticalOffsetBezierPathLineToPoint( path, fn CGPointMake( x, y ) )nextBezierPathStrokeFill( path, 2.0, fn ColorGreen, NULL )               // Set the stroke color and line width (no fill)end fnvoid local fn DoDialog( ev as long, tag as long, wnd as long, obj as CFTypeRef )select ( ev )case _viewDrawRectselect ( tag )case _windowContentViewTag : fn SineWave( tag )end selectcase _windowWillClose : endend selectend fnon dialog fn DoDialogfn BuildWindowHandleEvents