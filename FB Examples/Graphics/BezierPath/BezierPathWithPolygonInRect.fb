_window = 1begin enum 1_drawView_horizLine_sidesLabel_sidesFld_sidesStepper_widthLabel_widthFld_widthStepper_radiusLabel_radiusFld_radiusStepperend enumvoid local fn BuildWindowwindow _window, @"BezierPathWithPolygonInRect", (0,0,500,539)subclassview _drawView, (20,59,460,460)ViewSetFlipped( _drawView, YES )box _horizLine,, (20,48,460,5), NSBoxSeparatortextlabel _sidesLabel, @"Sides", (18,22,42,17)textfield _sidesFld,, @"3", (66,20,40,22)stepper _sidesStepper,, 3, (107,17,19,28), 3textlabel _widthLabel, @"Line width", (159,22,70,17)textfield _widthFld,, @"5", (235,20,40,22)stepper _widthStepper,, 5, (276,17,19,28)textlabel _radiusLabel, @"Corner radius", (328,22,91,17)textfield _radiusFld,, @"20", (425,20,40,22)stepper _radiusStepper,, 20, (466,17,19,28)end fnvoid local fn DrawRect( tag as long )NSInteger sides = fn ControlIntegerValue( _sidesStepper )NSInteger wdth = fn ControlIntegerValue( _widthFld )NSInteger radius = fn ControlIntegerValue( _radiusFld )BezierPathRef path = fn BezierPathWithPolygonInRect( fn ViewBounds(tag), sides, wdth, radius )ColorSet( fn ColorRed )BezierPathStroke( path )end fnvoid local fn TextFieldAction( tag as long )NSInteger value = fn ControlIntegerValue( tag )select ( tag )case _sidesFldif ( value < 3 ) then value = 3 : ControlSetIntegerValue( _sidesFld, value )ControlSetIntegerValue( _sidesStepper, value )case _widthFld  : ControlSetIntegerValue( _widthStepper, value )case _radiusFld : ControlSetIntegerValue( _radiusStepper, value )end selectViewSetNeedsDisplay( _drawView )end fnvoid local fn StepperAction( tag as long )NSInteger value = fn ControlIntegerValue( tag )select ( tag )case _sidesStepper  : ControlSetIntegerValue( _sidesFld, value )case _widthStepper  : ControlSetIntegerValue( _widthFld, value )case _radiusStepper : ControlSetIntegerValue( _radiusFld, value )end selectViewSetNeedsDisplay( _drawView )end fnvoid local fn DoDialog( ev as long, tag as long )select ( ev )case _viewDrawRect : fn DrawRect( tag )case _textFieldDidEndEditing : fn TextFieldAction( tag )case _btnClickselect ( tag )case _sidesStepper, _widthStepper, _radiusStepper : fn StepperAction( tag )end selectend selectend fnfn BuildWindowon dialog fn DoDialogHandleEvents