/*  AnimationContext  macOS 10.12+*/include resources "image1.png"include resources "image2.png"_window = 1begin enum 1_imageView1_imageView2_animateBtnend enumvoid local fn AnimationHandler( ctx as AnimationContextRef, userData as ptr )NSInteger tag = fn NumberIntegerValue( fn DictionaryObjectForKey( userData, @"view" ) )CGPoint pt = fn ValuePoint( fn DictionaryObjectForKey( userData, @"point" ) )CGRect r = fn ViewFrame( tag )r.origin = ptAnimationContextBeginGroupingAnimationContextSetTimingFunction( ctx, fn CAMediaTimingFunctionWithName( kCAMediaTimingFunctionEaseInEaseOut ) )AnimationContextSetDuration( ctx, 1.5 )ViewSetFrame( fn ViewAnimator(tag), r )AnimationContextEndGroupingend fnvoid local fn AnimateViewsCGRect r1 = fn ViewFrame( _imageView1 )CGRect r2 = fn ViewFrame( _imageView2 )CGPoint pt1 = { 25, 158 }CGPoint pt2 = { 260, 93 }if ( r1.origin.x < 195 ) then pt1.x = 195if ( r2.origin.x > 145 ) then pt2.x = 145AnimationContextRunAnimationGroup( @fn AnimationHandler, (ptr)@{@"view":@(_imageView1),@"point":fn ValueWithPoint(pt1)} )AnimationContextRunAnimationGroup( @fn AnimationHandler, (ptr)@{@"view":@(_imageView2),@"point":fn ValueWithPoint(pt2)} )end fnvoid local fn BuildWindowwindow _window, @"AnimationContext", (0,0,480,360), NSWindowStyleMaskTitled + NSWindowStyleMaskClosableViewSetWantsLayer( _windowContentViewTag, YES )imageView _imageView1,, @"image1.png", (25,158,80,80)ViewSetWantsLayer( _imageView1, YES )imageView _imageView2,, @"image2.png", (260,93,174,174)ViewSetWantsLayer( _imageView2, YES )button _animateBtn,,, @"Animate", (195,13,90,32)end fnvoid local fn DoDialog( ev as long, tag as long )select ( ev )case _btnClickselect ( tag )case _animateBtn : fn AnimateViewsend selectcase _windowWillClose : endend selectend fnfn BuildWindowon dialog fn DoDialogHandleEvents