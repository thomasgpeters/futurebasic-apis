/*  IsAdministrator  Ken Shmidheiser 20201031*/include "NSLog.incl"local fn IsAdministrator( name as CFStringRef ) as BooleanTaskRef       tskCFStringRef   cmdStr, outputStrCFArrayRef    arguments, arrPipeRef       pipFileHandleRef fhCFDataRef     dtaBoolean       result = NOtsk = fn TaskInitTaskSetExecutableURL( tsk, fn URLFileURLWithPath( @"/bin/sh" ) )cmdStr = fn StringWithFormat( @"dscl . -read /Groups/admin GroupMembership" )arguments = @[@"-c", cmdStr]TaskSetArguments( tsk, arguments )pip = fn PipeInitTaskSetStandardOutput( tsk, pip )fh = fn PipeFileHandleForReading( pip )fn TaskLaunch( tsk, NULL )TaskWaitUntilExit( tsk )dta = fn FileHandleReadDataToEndOfFile( fh, NULL )outputStr = fn StringWithData( dta, NSUTF8StringEncoding )outputStr = fn StringByReplacingOccurrencesOfString( outputStr, @"GroupMembership: ", @"" )outputStr = fn StringByReplacingOccurrencesOfString( outputStr, @"\n", @"" )arr = fn StringComponentsSeparatedByString( outputStr, @" " )result = fn ArrayContainsObject( arr, name )end fn = resultCFStringRef namename = @"root"if ( fn IsAdministrator( name ) ) then NSLog( @"%@ is an administrator", name ) else NSLog( @"%@ is not an administrator", name )name = @"bern"if ( fn IsAdministrator( name ) ) then NSLog( @"%@ is an administrator", name ) else NSLog( @"%@ is not an administrator", name )HandleEvents