begin enum 1_mFile_mEdit_mFindend enum_window = 1begin enum 1_findBtn// must have tag value '1' (NSTextFinderActionShowFindInterface) to trigger find_toggleBtn_scrollView_textViewend enumvoid local fn BuildMenufilemenu _mFileeditmenu _mEditfindmenu _mFindend fnvoid local fn BuildWindowwindow _window, @"TextFinderPerformAction", (0,0,480,360)WindowSetContentMinSize( _window, fn CGSizeMake(360,160) )CGRect r = fn WindowContentRect(_window)r.origin.x = 0 : r.origin.y = 0scrollview _scrollView, (20,60,440,280), NSBezelBorderViewSetAutoresizingMask( _scrollView, NSViewWidthSizable + NSViewHeightSizable )textview _textView,, _scrollViewTextViewSetUsesFindBar( _textView, YES )TextSetString( _textView, @"if blabla\nif blablabla // then do something\nend if\nend if\n" )TextFinderRef textFinder = fn TextFinderInitTextFinderSetClient( textFinder, (TextFinderClientRef)fn TextViewWithTag(_textView) )TextFinderSetFinderBarContainer( textFinder, (TextFinderBarContainerRef)fn ScrollViewWithTag(_scrollView) )ViewPropertySet( _textView, @"textFinder", textFinder )button _findBtn,,, @"Find", (13,13,75,32)//ControlSetAction( _findBtn, @"performFindPanelAction:" )ViewSetAutoresizingMask( _findBtn, NSViewMaxYMargin )button _toggleBtn,,, @"Toggle", (86,13,70,32)ViewSetAutoresizingMask( _toggleBtn, NSViewMaxYMargin )WindowMakeFirstResponder( _window, _textView )end fnvoid local fn ToggleFindBarTextFinderRef textFinder = fn ViewProperty( _textView, @"textFinder" )if ( textFinder )if ( fn TextFinderBarContainerIsFindBarVisible(fn TextFinderFinderBarContainer(textFinder)) )TextFinderPerformAction( textFinder, NSTextFinderActionHideFindInterface )elseTextFinderPerformAction( textFinder, NSTextFinderActionShowFindInterface )end ifend ifend fnvoid local fn DoDialog( ev as long, tag as long, wnd as long )select ( ev )case _btnClickselect ( tag )case _findBtn : TextViewPerformFindPanelAction( _textView, NSTextFinderActionShowFindInterface )case _toggleBtn : fn ToggleFindBarend selectend selectend fnfn BuildMenufn BuildWindowon dialog fn DoDialogHandleEvents