/*  TableView Drag Drop 3  Drag from Finder + drag re-order rows*/include "Tlbx UTCoreTypes.incl"_window = 1begin enum output 1_tableViewend enumvoid local fn TableDataInsertArray( array as CFArrayRef, row as NSInteger )IndexSetRef         indexesCFMutableArrayRef   tableDatatableData = fn TableViewData( _tableView )indexes = fn IndexSetWithIndexesInRange( fn CFRangeMake( row, fn ArrayCount(array) ) )MutableArrayInsertObjectsAtIndexes( tableData, array, indexes )TableViewInsertRows( _tableView, indexes, NSTableViewAnimationEffectGap )end fnvoid local fn BuildWindownibwindow _window, @"Window"window _window, @"Drag files from Finder and Reorder rows"ViewRegisterForDraggedTypes( _tableView, @[TABLEVIEW_REORDER_PASTEBOARD_TYPE,kUTTypeFileURL] )end fnvoid local fn DoDialog( ev as long, tag as long )CFArrayRef          urlsCFURLRef            urlCFMutableArrayRef   filenamesCFStringRef         stringNSInteger           rowselect ( ev )case _tableViewAcceptDropfilenames = fn MutableArrayWithCapacity(0)urls = fn DialogEventArrayfor url in urlsstring = fn URLLastPathComponent(url)MutableArrayAddObject( filenames, string )nextrow = fn DialogEventLongfn TableDataInsertArray( filenames, row )case _windowWillClose : endend selectend fnfn BuildWindowon dialog fn DoDialogHandleEvents