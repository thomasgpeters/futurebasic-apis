include resources "flowers.jpg"_window = 1begin enum 1_imageview_colorWellend enumvoid local fn BuildWindowCGRect r = (0,0,500,400)window _window, @"ColorUnderMouse", r, NSWindowStyleMaskTitled + NSWindowStyleMaskClosabler = fn CGRectMake(0,0,400,380)subclass imageview _imageview, YES, @"flowers", r, NSImageScaleAxesIndependently, NSImageAlignCenter, NSImageFramePhoto, _windowViewInitTrackingArea( _imageView )r = fn CGRectMake(410,310,70,70)colorwell _colorWell, YES, fn ColorWhite, (410,310,70,70),, _windowColorWellSetBordered( _colorWell, NO )cls	// prevent arrow cursor showing on first clickend fnvoid local fn DoMouse( tag as NSInteger )CursorSetCrosshairCGPoint pt = fn EventLocationInView( tag )ColorRef color = fn ViewColorAtPoint( tag, pt )ColorWellSetColor( _colorWell, color )cls : printf @"%.0fx, %.0fy, %@", pt.x, pt.y, colorend fnvoid local fn DoDialog( ev as long, tag as long )select ( tag )case _imageviewselect ( ev )case _viewMouseUpif ( fn CGRectContainsPoint( fn ViewFrame(tag), fn EventLocationInView(tag) ) == NO ) then CursorSetArrowcase _viewMouseEntered                 : CursorSetCrosshaircase _viewMouseExited                  : CursorSetArrowcase _viewMouseDown, _viewMouseDragged : fn DoMouse( tag )end selectend selectselect ( ev )case _windowWillClose : endend selectend fnfn BuildWindowon dialog fn DoDialogHandleEvents