/*  SpriteKit Spiral Demo  Based on Steve Van Voorst's Objective-C Demo  which, in turn, was based on a Apple example.  Converted to CocoaUI  08132021 Ken Shmidheiser*/output file "SpriteKit Spiral Demo"include "Tlbx SpriteKit.incl"include resources "spiral.png"// window_window = 1begin enum 1_animateBtn_quitBtn_skViewend enumvoid local fn StartAnimationCGPoint         locationSKSpriteNodeRef nodeSKActionRef     actionSKSceneRef      sceneskview _skViewscene    = fn SKSceneWithSize( fn CGSizeMake( 550, 550 ) )node     = fn SKSpriteNodeWithImageNamed( @"spiral" )location = fn CGPointMake( 275, 275 )SKNodeSetPosition( node, location )action   = fn SKActionRotateByAngle( -pi, 0.7 )SKSceneSetScaleMode( scene, SKSceneScaleModeResizeFill )SKViewPresentScene( _skView, scene )action   = fn SKActionRepeatActionForever( action )SKNodeRunActionWithKey( node, action, @"rotationAction" )SKNodeAddChild( scene, node )AppPropertySet( @"spiralNode", node )end fnvoid local fn StopAnimationSKSpriteNodeRef  nodenode = fn AppProperty( @"spiralNode" )SKNodeRemoveActionForKey( node, @"rotationAction" )skview -_skViewend fnvoid local fn BuildWindowCGRect  rr = fn CGRectMake( 0, 0, 550, 580 )window _window, @"Animated Spiral", r, NSWindowStyleMaskTitled + NSWindowStyleMaskClosable + NSWindowStyleMaskMiniaturizabler = fn CGRectMake( 0, 50, 550, 530 )skview -_skView, r, _windowr = fn CGRectMake( 340, 13, 105, 24 )button _animateBtn, YES, NSControlStateValueOff, @"Start animation", r, NSButtonTypePushOnPushOff, NSBezelStyleInlineButtonSetTransparent( _animateBtn, NO )r = fn CGRectMake( 455, 13, 80, 24 )button _quitBtn,,, @"Quit", r, NSButtonTypeMomentaryLight, NSBezelStyleInlineButtonSetTransparent( _quitBtn, NO )end fnvoid local fn DoDialog( ev as long, tag as long, wnd as long )select ( ev )case _btnClickselect ( tag )case _animateBtnif ( fn ButtonState( tag ) == NSControlStateValueOn )fn StartAnimationButtonSetTitle( tag, @"Stop animation" )elsefn StopAnimationButtonSetTitle( tag, @"Start animation" )end ifcase _quitBtn     : endend selectcase _windowWillClose : endend selectend fnon dialog fn DoDialogfn BuildWindowHandleEvents