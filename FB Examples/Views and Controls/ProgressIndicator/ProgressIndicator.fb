/*  ProgressIndicator    More user-friendly code Ken Shmidheiser 2080822*/_window = 1begin enum 1_prog1_prog2_prog3_prog4_startBtn_stopBtnend enumvoid local fn BuildWindowwindow _window, @"Progress Indicator", (0,0,300,200)// params: tag, value, rect, min, max, wndTagprogressbar _prog1,, (20,161,260,20)ProgressIndicatorSetIndeterminate( _prog1, YES )ProgressIndicatorSetUsesThreadedAnimation( _prog1, NO )// fix cosmetic on Big Sur and aboveprogressbar _prog2, 50, (20,126,260,20)progressindicator _prog3,, (92,85,16,16)ProgressIndicatorSetStyle( _prog3, NSProgressIndicatorStyleSpinning )ProgressIndicatorSetIndeterminate( _prog3, YES )progressindicator _prog4, 50, (192,85,16,16)ProgressIndicatorSetStyle( _prog4, NSProgressIndicatorStyleSpinning )button _startBtn,, NSControlStateValueOn, @"Start", (75,13,70,32)button _stopBtn,, NSControlStateValueOn, @"Stop", (145,13,70,32)end fnvoid local fn DoDialog( ev as long, tag as long )select ( ev )case _btnClickselect ( tag )case _startBtnProgressIndicatorStartAnimation( _prog1 )ProgressIndicatorStartAnimation( _prog3 )case _stopBtnProgressIndicatorStopAnimation( _prog1 )ProgressIndicatorStopAnimation( _prog3 )end selectend selectend fnfn BuildWindowon dialog fn DoDialogHandleEvents