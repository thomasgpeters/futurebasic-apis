/*  macOS 10.10+*/#define SHAKE_COUNT 2#define SHAKE_DURATION 0.3#define SHAKE_VIGOUR 0.1_window = 1begin enum 1_imageView_passwordFld_loginBtnend enumlocal fn ShakeAnimation( frame as CGRect ) as CAKeyframeAnimationRefCAKeyframeAnimationRef   animationBezierPathRef            pathCGFloat                  minX, minY, wdthlong                     indexminX = fn CGRectGetMinX(frame)minY = fn CGRectGetMinY(frame)wdth = frame.size.widthanimation = fn CAKeyframeAnimationInitpath = fn BezierPathInitBezierPathMoveToPoint( path, fn CGPointMake(minX,minY) )for index = 1 to SHAKE_COUNTBezierPathLineToPoint( path, fn CGPointMake(minX - wdth * SHAKE_VIGOUR, minY) )BezierPathLineToPoint( path, fn CGPointMake(minX + wdth * SHAKE_VIGOUR, minY) )nextCAKeyFrameAnimationSetPath( animation, path )AnimationSetDuration( (AnimationRef)animation, SHAKE_DURATION )end fn = animationvoid local fn ShakeWindowCGRect frame = fn WindowFrame(_window)WindowSetAnimations( _window, @{@"frameOrigin":fn ShakeAnimation(frame)} )WindowSetFrameOrigin( fn WindowAnimator(_window), frame.origin )end fnvoid local fn BuildWindowwindow _window, @"Shake", (0,0,299,169), NSWindowStyleMaskTitledimageview _imageView,, NSImageNameUser, (99,49,100,100), NSImageScaleProportionallyUpOrDownsecuretextfield _passwordFld,,, (20,20,237,21)TextFieldSetPlaceholderString( _passwordFld, @"Enter Password" )ViewSetFocusRingType( _passwordFld, NSFocusRingTypeNone )button _loginBtn,,, @"", (265,24,14,14),, NSBezelStyleSmallSquareButtonSetBordered( _loginBtn, NO )ButtonSetImage( _loginBtn, NSImageNameFollowLinkFreestandingTemplate )ButtonSetKeyEquivalent( _loginBtn, @"\r" )ViewSetHidden( _loginBtn, YES )WindowMakeFirstResponder( _window, _passwordFld )end fnvoid local fn DoDialog( ev as long, tag as long )select ( ev )case _btnClick : fn ShakeWindowcase _controlTextDidChangeif ( fn StringLength( fn ControlStringValue(tag) ) )ViewSetHidden( _loginBtn, NO )elseViewSetHidden( _loginBtn, YES )end ifend selectend fnfn BuildWindowon dialog fn DoDialogHandleEvents