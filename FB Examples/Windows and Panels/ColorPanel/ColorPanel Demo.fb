/*  ColorPanel Demo*/_window = 1begin enum 1_view_redLabel_redFld_greenLabel_greenFld_blueLabel_blueFldend enumvoid local fn UpdateColorFieldsColorRef   colCGFloat    r, g, bcol = fn ColorPanelColorColorGetRGB( col, @r, @g, @b, NULL )ControlSetDoubleValue( _redFld, r )ControlSetDoubleValue( _greenFld, g )ControlSetDoubleValue( _blueFld, b )end fnvoid local fn ViewDrawRect( tag as NSInteger )BezierPathStrokeFillRect( fn ViewBounds( tag ), 4.0, fn ColorBlack, fn ColorPanelColor )fn UpdateColorFieldsend fnvoid local fn BuildWindowwindow _window, @"Color Panel", ( 0, 0, 520, 550 ), NSWindowStyleMaskTitledtextlabel _redLabel, @"Red:", (18,511,32,17)textfield _redFld,,, (56,508,110,22)TextFieldSetSelectable( _redFld, NO )textlabel _greenLabel, @"Green:", (180,511,45,17)textfield _greenFld,,, (231,508,110,22)TextFieldSetSelectable( _greenFld, NO )textlabel _blueLabel, @"Blue:", (349,511,35,17)textfield _blueFld,,, (390,508,110,22)TextFieldSetSelectable( _blueFld, NO )subclass view _view, (20,20,480,480)ColorPanelSetMode( NSColorPanelModeWheel )ColorPanelShowColorPanelSetColor( fn ColorRed )// initialize color panel or we'll crashfn UpdateColorFieldsend fnvoid local fn DoDialog( ev as long )select ( ev )case _viewMouseDownColorPanelShowcase _viewDrawRectfn ViewDrawRect (_view)case _colorPanelChangeColorViewSetNeedsDisplay( _view )end selectend fnfn BuildWindowon dialog fn DoDialogHandleEvents