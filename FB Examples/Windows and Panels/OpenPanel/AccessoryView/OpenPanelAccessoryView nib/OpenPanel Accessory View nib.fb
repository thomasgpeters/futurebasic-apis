include "NSLog.incl"// window_window = 1_openBtn = 1// open panel_openPanel = 1000begin enum 1001_openPanelAccessoryView_openPanelPopUp_openPanelCheckbox1_openPanelCheckbox2_openPanelCheckbox3end enumlocal fn BuildAccessoryView as ViewRefend fn = nibview _openPanelAccessoryView, @"AccessoryView"void local fn ShowOpenPanelOpenPanelSetAccessoryView( _openPanel, fn BuildAccessoryView )CFURLRef url = openpanel _openPanel, @"Open a file", @"txt"if ( url )NSLog(@"%@",url)elseNSLog(@"User cancelled")end ifend fnvoid local fn DoDialog( ev as long, tag as long, wnd as long, obj as CFTypeRef )select ( ev )case _btnClickselect ( tag )case _openBtn : fn ShowOpenPanelcase _openPanelPopUpopenpanel _openPanel,, fn PopUpButtonTitleOfSelectedItem(obj)NSLog(@"openpanel %ld, \"%@\"",wnd,fn PopUpButtonTitleOfSelectedItem(obj))case _openPanelCheckbox1, _openPanelCheckbox2, _openPanelCheckbox3NSLog(@"openpanel %ld, %@ state: %ld", wnd, fn ButtonTitle(obj),fn ButtonState(obj))end selectend selectend fnnibwindow _window, @"MainWindow"on dialog fn DoDialogHandleEvents