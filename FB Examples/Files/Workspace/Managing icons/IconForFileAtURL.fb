void local fn GetFileIconOpenPanelSetTreatsFilePackagesAsDirectories( 1, YES )OpenPanelSetCanChooseDirectories( 1, YES )CFURLRef url = openpanel 1if ( url )ImageRef image = fn WorkspaceIconForFileAtURL( url )window 1ImageViewSetImage( 2, image )end ifend fnvoid local fn BuildWindowwindow 1, @"IconForFileAtURL", (0,0,550,400)button 1,,, @"Choose Fileâ€¦", (14,13,122,32)imageview 2,,, (227,152,96,96), NSImageScaleProportionallyUpOrDownend fnvoid local fn DoDialog( ev as long )if ( ev == _btnClick )fn GetFileIconend ifend fnfn BuildWindowon dialog fn DoDialogHandleEvents