/*  FileHandle ReadWrite  Bernie Wylde 20180619*/_window = 1begin enum 1_scrollView_textView_readBtn_writeBtn_labelend enumvoid local fn ReadActionCFURLRef      desktopURL, fileURLCFDataRef     dtaCFStringRef   stringdesktopURL = fn FileManagerURLForDirectory( NSDesktopDirectory, NSUserDomainMask )fileURL = fn URLByAppendingPathComponent( desktopURL, @"MyTestFile" )FileHandleRef fh = fn FileHandleForReadingFromURL( fileURL, NULL )if ( fh )dta = fn FileHandleReadDataToEndOfFile( fh, NULL )string = fn StringWithData( dta, NSUTF8StringEncoding )TextSetString( _textView, string )end ifend fnvoid local fn WriteActionCFURLRef   desktopURL, fileURLdesktopURL = fn FileManagerURLForDirectory( NSDesktopDirectory, NSUserDomainMask )fileURL = fn URLByAppendingPathComponent( desktopURL, @"MyTestFile" )if ( fn FileManagerFileExistsAtURL( fileURL ) == NO )fn FileManagerCreateFileAtURL( fileURL, NULL, NULL )end ifFileHandleRef fh = fn FileHandleForUpdatingURL( fileURL, NULL )fn FileHandleSeekToEnd( fh, NULL, NULL )CFStringRef string = fn StringWithFormat( @"%@\n", fn TextString(_textView) )fn FileHandleWriteData( fh, fn StringData( string, NSUTF8StringEncoding ), NULL )fn FileHandleClose( fh, NULL )end fnvoid local fn BuildWindowwindow _window, @"FileHandle Demo", (0,0,565,400), NSWindowStyleMaskTitledscrollview _scrollView, (20,61,525,319), NSBezelBordertextview _textView,, _scrollViewTextSetString( _textView, @"Some text" )button _readBtn,,, @"Read", (14,13,73,32)button _writeBtn,,, @"Write", (87,13,73,32)textlabel _label, @"Read from/add text to file 'MyTestFile' on the Desktop.", (164,22,368,17)end fnvoid local fn DoDialog( ev as long, tag as long )select ( ev )case _btnClickselect ( tag )case _readBtn  : fn ReadActioncase _writeBtn : fn WriteActionend selectend selectend fneditmenu 1fn BuildWindowon dialog fn DoDialogHandleEvents