/*  List Serial Ports  From a demo by Ken Shmidheiser*/output file "List serial ports"local fn SerialPorts as CFArrayRefCFMutableArrayRef   arrayio_iterator_t       serialPortIteratorio_object_t         serialPortCFTypeRef           propertyarray = fn MutableArrayWithCapacity(0)fn IOServiceGetMatchingServices( kIOMasterPortDefault, fn IOServiceMatching( kIOSerialBSDServiceValue ), @serialPortIterator )serialPort = fn IOIteratorNext( serialPortIterator )while ( serialPort )property = fn IORegistryEntryCreateCFProperty( serialPort, kIOCalloutDeviceKey, _kCFAllocatorDefault, 0 )MutableArrayAddObject( array, property )CFRelease( property )fn IOObjectRelease( serialPort )serialPort = fn IOIteratorNext( serialPortIterator )wendfn IOObjectRelease( serialPortIterator )end fn = arraywindow 1, @"Serial Ports", (0,0,500,200)popupbutton 1,,, fn SerialPorts, (18,86,1,1)ControlSizeToFit(1)HandleEvents