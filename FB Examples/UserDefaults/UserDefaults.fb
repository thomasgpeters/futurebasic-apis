/* Demonstrates UserDefaults Written by S.Van Voorst {Sep 24, 2018}*/_wndW = 650_wndH = 500_window = 1begin enum 1_scrlView_txtview_labelBkgrnd_bkgrndColorWell_txtColorWell_labelTxt_defaultsBtn_quitBtnend enumvoid local fn RegisterDefaultsColorRef          bkgrndColor, txtColorCFDictionaryRef   defaultsbkgrndColor = fn ColorWithRGB( 0.7, 0.9, 1.0, 1.0)txtColor = fn ColorWhitedefaults = @{@"BackgroundColorKey":bkgrndColor,@"TextColorKey":txtColor}UserDefaultsRegisterDefaults( defaults )end fnvoid local fn RetrieveArchivedDataColorRef   bkgrndColor, txtColorbkgrndColor = fn UserDefaultsColor(@"BackgroundColorKey")ColorWellSetColor(_bkgrndColorWell, bkgrndColor)TextViewSetBackgroundColor( _txtView, bkgrndColor )txtColor = fn UserDefaultsColor(@"TextColorKey")ColorWellSetColor(_txtColorWell, txtColor)TextSetColor( _txtView, txtColor )end fnvoid local fn ResetDefaultsUserDefaultsRemoveObject( @"BackgroundColorKey" )UserDefaultsRemoveObject( @"TextColorKey" )fn RetrieveArchivedDataend fnvoid local fn BuildWindowwindow _window, @"User Defaults Demo", ( 0, 0, _wndW, _wndH )WindowSetContentMinSize( _window, fn CGSizeMake(410,140) )scrollview _scrlView, ( 20, 20, _wndW - 40, _wndH - 78), NSBezelBordertextview _txtView,, _scrlViewViewSetAutoresizingMask( _scrlView, NSViewWidthSizable + NSViewHeightSizable )TextSetString(_txtView, @"User Defaults Example")TextSetFontWithName(_txtView, @"Lucida Grande", 18.0)textlabel _labelBkgrnd, @"Background", (18, _wndH - 44, 77, 17)colorwell _bkgrndColorWell,,, ( 101,  _wndH - 50, 44, 30 )textlabel _labelTxt, @"Text", (174, _wndH - 44, 30, 17)colorwell _txtColorWell,,, ( 210,  _wndH - 50, 44, 30 )button _defaultsBtn,,, @"Reset Defaults", ( _wndW - 143, _wndH - 53, 129, 32 )ViewSetAutoresizingMask( _defaultsBtn, NSViewMinXMargin + NSViewMinYMargin )end fnvoid local fn DoDialog( ev as long, id as long )ColorRef   theColorselect ( ev )case _btnClickselect ( id )case _bkgrndColorWelltheColor = fn ColorWellColor(_bkgrndColorWell)TextViewSetBackgroundColor( _txtView, theColor )UserDefaultsSetColor( @"BackgroundColorKey", theColor )case _txtColorWelltheColor = fn ColorWellColor(_txtColorWell)TextSetColor( _txtView, theColor )UserDefaultsSetColor( @"TextColorKey", theColor )case _defaultsBtnfn ResetDefaultsend selectend selectend fnfn RegisterDefaultsfn BuildWindowfn RetrieveArchivedDataon dialog fn DoDialogHandleEvents