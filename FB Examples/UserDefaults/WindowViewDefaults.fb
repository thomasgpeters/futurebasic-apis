_mainWindow = 1_showPrefsBtn = 1_prefsWindow = 2begin enum 1_okBtn_cancelBtn_check1_check2_check3_check4_radio1_radio2_radio3_label1_fld1_label2_fld2end enumvoid local fn BuildPreferencesWindowwindow _prefsWindow, @"Preferences", (0,0,320,204), NSWindowStyleMaskTitled + NSWindowStyleMaskClosable + NSWindowStyleMaskMiniaturizablebutton _okBtn,,, @"OK", (224,13,82,32)button _cancelBtn,,, @"Cancel", (142,13,82,32)button _check1,,, @"Check1", (18,168,69,18), NSButtonTypeSwitchbutton _check2,,, @"Check2", (18,148,69,18), NSButtonTypeSwitchbutton _check3,,, @"Check3", (18,128,69,18), NSButtonTypeSwitchbutton _check4,,, @"Check4", (18,108,69,18), NSButtonTypeSwitchbutton _radio1,, NSOnState, @"Radio1", (19,67,62,18), NSButtonTypeRadiobutton _radio2,,, @"Radio2", (86,67,64,18), NSButtonTypeRadiobutton _radio3,,, @"Radio3", (155,67,65,18), NSButtonTypeRadiotextlabel _label1, @"Fld1:", (165,165,35,17)textfield _fld1,,, (204,162,96,22)textlabel _label2, @"Fld2:", (165,138,35,17)textfield _fld2,,, (204,135,96,22)WindowMakeFirstResponder( _prefsWindow, _fld1 )UserDefaultsRestoreWindowViewValues( _prefsWindow, NULL )end fnvoid local fn BuildMainWindowwindow _mainWindow, @"Main Window", (200,450,550,400)button _showPrefsBtn,,, @"Show Preferences", (14,13,150,32)end fnvoid local fn DoDialog( ev as long, tag as long, wnd as long )select ( ev )case _btnClickselect ( wnd )case _mainWindowselect ( tag )case _showPrefsBtnfn BuildPreferencesWindowend selectcase _prefsWindowselect ( tag )case _okBtnUserDefaultsStoreWindowViewValues( wnd, NULL )WindowClose( wnd )case _cancelBtnWindowClose( wnd )end selectend selectend selectend fnfn BuildMainWindowon dialog fn DoDialogHandleEvents