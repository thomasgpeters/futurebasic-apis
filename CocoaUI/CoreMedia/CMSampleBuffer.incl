/*  CMSampleBuffer.incl  Bernie Wylde 20210804  Framework: CoreMedia*/// sample timing info#if ndef _DEFINEDINCOCOAbegin record CMSampleTimingInfoCMTime durationCMTime presentationTimeStampCMTime decodeTimeStampend record#endif// keyssystem CFStringRef kCMSampleAttachmentKey_NotSync  // CFBoolean (absence of this key implies Sync)system CFStringRef kCMSampleAttachmentKey_PartialSync  // CFBoolean (absence of this key implies not Partial Sync. If NotSync is false, PartialSync should be ignored.)system CFStringRef kCMSampleAttachmentKey_HasRedundantCoding  // kCFBooleanTrue, kCFBooleanFalse, or absent if unknownsystem CFStringRef kCMSampleAttachmentKey_IsDependedOnByOthers  // kCFBooleanTrue, kCFBooleanFalse, or absent if unknownsystem CFStringRef kCMSampleAttachmentKey_DependsOnOthers  // kCFBooleanTrue (e.g., non-I-frame), kCFBooleanFalse (e.g. I-frame), or absent if unknownsystem CFStringRef kCMSampleAttachmentKey_EarlierDisplayTimesAllowed  // CFBooleansystem CFStringRef kCMSampleAttachmentKey_DisplayImmediately  // CFBooleansystem CFStringRef kCMSampleAttachmentKey_DoNotDisplay  // CFBooleansystem CFStringRef kCMSampleBufferAttachmentKey_ResetDecoderBeforeDecoding  // CFBooleansystem CFStringRef kCMSampleBufferAttachmentKey_DrainAfterDecoding  // CFBooleansystem CFStringRef kCMSampleBufferAttachmentKey_PostNotificationWhenConsumed  // CFDictionary (client-defined)system CFStringRef kCMSampleBufferAttachmentKey_ResumeOutput  // CFNumber (ResumeTag)system CFStringRef kCMSampleAttachmentKey_HEVCTemporalLevelInfo  // CFDictionary(kCMHEVCTemporalLevelInfoKey_*), optional.  Corresponds to 'tscl' sample group.system CFStringRef kCMHEVCTemporalLevelInfoKey_TemporalLevel					// CFNumber(Int)system CFStringRef kCMHEVCTemporalLevelInfoKey_ProfileSpace					// CFNumber(Int)system CFStringRef kCMHEVCTemporalLevelInfoKey_TierFlag						// CFNumber(Int)system CFStringRef kCMHEVCTemporalLevelInfoKey_ProfileIndex					// CFNumber(Int)system CFStringRef kCMHEVCTemporalLevelInfoKey_ProfileCompatibilityFlags		// CFData(4 bytes)system CFStringRef kCMHEVCTemporalLevelInfoKey_ConstraintIndicatorFlags		// CFData(6 bytes)system CFStringRef kCMHEVCTemporalLevelInfoKey_LevelIndex						// CFNumber(Int)system CFStringRef kCMSampleAttachmentKey_HEVCTemporalSubLayerAccess			// CFBoolean, optional.  Corresponds to 'tsas' sample group.system CFStringRef kCMSampleAttachmentKey_HEVCStepwiseTemporalSubLayerAccess  // CFBoolean, optional.  Corresponds to 'stsa' sample group.system CFStringRef kCMSampleAttachmentKey_HEVCSyncSampleNALUnitType			// CFNumber(Int), optional.  Corresponds to 'sync' sample group.#if _MACOSMAXALLOWED >= 101500system CFStringRef kCMSampleAttachmentKey_AudioIndependentSampleDecoderRefreshCount	// CFNumber(Int), optional. // macOS 10.15+#endif // 101500system CFStringRef kCMSampleBufferAttachmentKey_TransitionIDsystem CFStringRef kCMSampleBufferAttachmentKey_TrimDurationAtStart  // CFDictionary/CMTime, default 0system CFStringRef kCMSampleBufferAttachmentKey_TrimDurationAtEnd  // CFDictionary/CMTime, default 0system CFStringRef kCMSampleBufferAttachmentKey_SpeedMultiplier  // CFNumber, positive, default 1system CFStringRef kCMSampleBufferAttachmentKey_Reverse  // CFBoolean, default falsesystem CFStringRef kCMSampleBufferAttachmentKey_FillDiscontinuitiesWithSilence  // CFBoolean, default falsesystem CFStringRef kCMSampleBufferAttachmentKey_EmptyMedia  // CFBoolean, default falsesystem CFStringRef kCMSampleBufferAttachmentKey_PermanentEmptyMedia  // CFBoolean, default falsesystem CFStringRef kCMSampleBufferAttachmentKey_DisplayEmptyMediaImmediatelysystem CFStringRef kCMSampleBufferAttachmentKey_EndsPreviousSampleDuration  // CFBoolean, default falsesystem CFStringRef kCMSampleBufferAttachmentKey_SampleReferenceURL  // CFURLsystem CFStringRef kCMSampleBufferAttachmentKey_SampleReferenceByteOffset  // CFNumber, byte offset from beginning of URL to contiguous datasystem CFStringRef kCMSampleBufferAttachmentKey_GradualDecoderRefresh  // CFNumber, audio decoder refresh countsystem CFStringRef kCMSampleBufferAttachmentKey_DroppedFrameReason  // CFString, frame drop reasonsystem CFStringRef kCMSampleBufferDroppedFrameReason_FrameWasLatesystem CFStringRef kCMSampleBufferDroppedFrameReason_OutOfBufferssystem CFStringRef kCMSampleBufferDroppedFrameReason_Discontinuitysystem CFStringRef kCMSampleBufferAttachmentKey_DroppedFrameReasonInfosystem CFStringRef kCMSampleBufferDroppedFrameReasonInfo_CameraModeSwitchsystem CFStringRef kCMSampleBufferAttachmentKey_StillImageLensStabilizationInfo  // CFString, one of kCMSampleBufferLensStabilizationInfo_*system CFStringRef kCMSampleBufferLensStabilizationInfo_Active  // CFStringsystem CFStringRef kCMSampleBufferLensStabilizationInfo_OutOfRange  // CFStringsystem CFStringRef kCMSampleBufferLensStabilizationInfo_Unavailable  // CFStringsystem CFStringRef kCMSampleBufferLensStabilizationInfo_Off  // CFStringsystem CFStringRef kCMSampleBufferAttachmentKey_CameraIntrinsicMatrix  // CFData (matrix_float3x3)system CFStringRef kCMSampleBufferAttachmentKey_ForceKeyFrame#if _MACOSMAXALLOWED >= 120000system CFStringRef kCMSampleAttachmentKey_CryptorSubsampleAuxiliaryData // CFData // macOS 12.0+#endif // 120000#if _MACOSMAXALLOWED >= 130000system CFStringRef kCMSampleAttachmentKey_HDR10PlusPerFrameData // CFData // macOS 13.0+#endif // 130000#if _MACOSMAXALLOWED >= 150000system CFStringRef kCMSampleAttachmentKey_PostDecodeProcessingMetadata // CFDictionary // macOS 15.0+#endif // 150000// notificationssystem CFStringRef kCMSampleBufferNotification_DataBecameReadysystem CFStringRef kCMSampleBufferNotification_DataFailedsystem CFStringRef kCMSampleBufferNotificationParameter_OSStatussystem CFStringRef kCMSampleBufferConduitNotification_InhibitOutputUntil  // payload: CFDictionary containing:system CFStringRef kCMSampleBufferConduitNotificationParameter_ResumeTag  // payload: CFNumbersystem CFStringRef kCMSampleBufferConduitNotification_ResetOutputsystem CFStringRef kCMSampleBufferConduitNotification_UpcomingOutputPTSRangeChanged  // payload: CFDictionary containing:system CFStringRef kCMSampleBufferConduitNotificationParameter_UpcomingOutputPTSRangeMayOverlapQueuedOutputPTSRange  // payload: CFBooleansystem CFStringRef kCMSampleBufferConduitNotificationParameter_MinUpcomingOutputPTS  // payload: CFDictionary(CMTime)system CFStringRef kCMSampleBufferConduitNotificationParameter_MaxUpcomingOutputPTS  // payload: CFDictionary(CMTime)system CFStringRef kCMSampleBufferConsumerNotification_BufferConsumed  // payload: CFDictionary// Createtoolbox fn CMSampleBufferCreateReady( CFAllocatorRef allocator,  CMBlockBufferRef dataBuffer, CMFormatDescriptionRef formatDescription, CMItemCount numSamples, CMItemCount numSampleTimingEntries, CMSampleTimingInfo *sampleTimingArray, CMItemCount numSampleSizeEntries, long *sampleSizeArray, CMSampleBufferRef *sampleBufferOut ) = OSStatus//toolbox fn CMSampleBufferCreateReadyWithImageBuffer( CFAllocatorRef allocator, CVImageBufferRef imageBuffer, CMVideoFormatDescriptionRef formatDescription, CMSampleTimingInfo *sampleTiming, CMSampleBufferRef *sampleBufferOut ) = OSStatustoolbox fn CMAudioSampleBufferCreateReadyWithPacketDescriptions( CFAllocatorRef allocator, CMBlockBufferRef dataBuffer, CMFormatDescriptionRef formatDescription, CMItemCount numSamples, CMTime presentationTimeStamp, AudioStreamPacketDescription *packetDescriptions, CMSampleBufferRef *sampleBufferOut ) = OSStatus#if _MACOSMAXALLOWED >= 101404/*  CMSampleBufferCreateWithMakeDataReadyHandler  handler:*/toolbox fn CMSampleBufferCreateWithMakeDataReadyHandler( CFAllocatorRef allocator, CMBlockBufferRef dataBuffer, Boolean dataReady, CMFormatDescriptionRef formatDescription, CMItemCount numSamples, CMItemCount numSampleTimingEntries, CMSampleTimingInfo *sampleTimingArray, CMItemCount numSampleSizeEntries, long *sampleSizeArray, CMSampleBufferRef *sampleBufferOut, CMSampleBufferMakeDataReadyHandler makeDataReadyHandler) = OSStatus // macOS 10.14.4+//toolbox fn CMSampleBufferCreateForImageBufferWithMakeDataReadyHandler( CFAllocatorRef allocator, CVImageBufferRef imageBuffer, Boolean dataReady, CMVideoFormatDescriptionRef formatDescription, CMSampleTimingInfo *sampleTiming, CMSampleBufferRef *sampleBufferOut, CMSampleBufferMakeDataReadyHandler makeDataReadyHandler ) = OSStatus // macOS 10.14.4+/*  CMAudioSampleBufferCreateWithPacketDescriptionsAndMakeDataReadyHandler  handler:*/toolbox fn CMAudioSampleBufferCreateWithPacketDescriptionsAndMakeDataReadyHandler( CFAllocatorRef allocator, CMBlockBufferRef dataBuffer, Boolean dataReady, CMFormatDescriptionRef formatDescription, CMItemCount numSamples, CMTime presentationTimeStamp, AudioStreamPacketDescription *packetDescriptions, CMSampleBufferRef *sampleBufferOut, CMSampleBufferMakeDataReadyHandler makeDataReadyHandler ) = OSStatus // macOS 10.14.4+#endif // 101404#if _MACOSMAXALLOWED >= 101400toolbox fn CMSampleBufferCreateForTaggedBufferGroup( CFAllocatorRef allocator, CMTaggedBufferGroupRef taggedBufferGroup, CMTime sbufPTS, CMTime sbufDuration, CMTaggedBufferGroupFormatDescriptionRef formatDescription, CMSampleBufferRef *sBufOut ) = OSStatus // macOS 10.14+#endif // 10140/*  CMSampleBufferCreate  callback:*/toolbox fn CMSampleBufferCreate( CFAllocatorRef allocator, CMBlockBufferRef dataBuffer, Boolean dataReady, CMSampleBufferMakeDataReadyCallback makeDataReadyCallback, ptr makeDataReadyRefcon, CMFormatDescriptionRef formatDescription, CMItemCount numSamples, CMItemCount numSampleTimingEntries, CMSampleTimingInfo *sampleTimingArray, CMItemCount numSampleSizeEntries, long *sampleSizeArray, CMSampleBufferRef *sampleBufferOut) = OSStatus//toolbox fn CMSampleBufferCreateForImageBuffer( CFAllocatorRef allocator, CVImageBufferRef imageBuffer, Boolean dataReady, CMSampleBufferMakeDataReadyCallback makeDataReadyCallback, ptr makeDataReadyRefcon, CMVideoFormatDescriptionRef formatDescription, CMSampleTimingInfo *sampleTiming, CMSampleBufferRef *sampleBufferOut) = OSStatustoolbox fn CMAudioSampleBufferCreateWithPacketDescriptions( CFAllocatorRef allocator, CMBlockBufferRef dataBuffer, Boolean dataReady, CMSampleBufferMakeDataReadyCallback makeDataReadyCallback, ptr makeDataReadyRefcon, CMFormatDescriptionRef formatDescription, CMItemCount numSamples, CMTime presentationTimeStamp, AudioStreamPacketDescription *packetDescriptions, CMSampleBufferRef *sampleBufferOut) = OSStatus// Copytoolbox fn CMSampleBufferCreateCopy( CFAllocatorRef allocator, CMSampleBufferRef sbuf, CMSampleBufferRef *sampleBufferOut) = OSStatustoolbox fn CMSampleBufferCreateCopyWithNewTiming( CFAllocatorRef allocator, CMSampleBufferRef originalSBuf, CMItemCount numSampleTimingEntries, CMSampleTimingInfo *sampleTimingArray, CMSampleBufferRef *sampleBufferOut) = OSStatustoolbox fn CMSampleBufferCopySampleBufferForRange( CFAllocatorRef allocator, CMSampleBufferRef sbuf, CFRange sampleRange, CMSampleBufferRef *sampleBufferOut ) = OSStatus// Readinesstoolbox fn CMSampleBufferDataIsReady( CMSampleBufferRef sbuf ) = Booleantoolbox fn CMSampleBufferSetDataReady( CMSampleBufferRef sbuf ) = OSStatustoolbox fn CMSampleBufferSetDataFailed( CMSampleBufferRef sbuf, OSStatus status ) = OSStatustoolbox fn CMSampleBufferHasDataFailed( CMSampleBufferRef sbuf, OSStatus *statusOut ) = Booleantoolbox fn CMSampleBufferMakeDataReady( CMSampleBufferRef sbuf ) = OSStatustoolbox fn CMSampleBufferTrackDataReadiness( CMSampleBufferRef sbuf, CMSampleBufferRef sampleBufferToTrack ) = OSStatus// Invalidatetoolbox fn CMSampleBufferSetInvalidateHandler( CMSampleBufferRef sbuf, CMSampleBufferInvalidateHandler invalidateHandler ) = OSStatustoolbox fn CMSampleBufferInvalidate( CMSampleBufferRef sbuf ) = OSStatustoolbox fn CMSampleBufferIsValid( CMSampleBufferRef sbuf ) = Boolean/*  CMSampleBufferSetInvalidateCallback  callback:*/toolbox fn CMSampleBufferSetInvalidateCallback( CMSampleBufferRef sbuf, CMSampleBufferInvalidateCallback invalidateCallback, UInt64 invalidateRefCon ) = OSStatus// Sizetoolbox fn CMSampleBufferGetNumSamples( CMSampleBufferRef sbuf ) = CMItemCounttoolbox fn CMSampleBufferGetTotalSampleSize( CMSampleBufferRef sbuf ) = longtoolbox fn CMSampleBufferGetSampleSize( CMSampleBufferRef sbuf, CMItemIndex sampleIndex ) = longtoolbox fn CMSampleBufferGetSampleSizeArray( CMSampleBufferRef sbuf, CMItemCount sizeArrayEntries, long *sizeArrayOut, CMItemCount *sizeArrayEntriesNeededOut ) = OSStatus// Duration and timingtoolbox fn CMSampleBufferGetDuration( CMSampleBufferRef sbuf ) = CMTimetoolbox fn CMSampleBufferGetDecodeTimeStamp( CMSampleBufferRef sbuf ) = CMTimetoolbox fn CMSampleBufferGetPresentationTimeStamp( CMSampleBufferRef sbuf ) = CMTimetoolbox fn CMSampleBufferGetOutputDuration( CMSampleBufferRef sbuf ) = CMTimetoolbox fn CMSampleBufferGetOutputDecodeTimeStamp( CMSampleBufferRef sbuf ) = CMTimetoolbox fn CMSampleBufferGetOutputPresentationTimeStamp( CMSampleBufferRef sbuf ) = CMTimetoolbox fn CMSampleBufferSetOutputPresentationTimeStamp( CMSampleBufferRef sbuf, CMTime outputPresentationTimeStamp ) = OSStatustoolbox fn CMSampleBufferGetSampleTimingInfo( CMSampleBufferRef sbuf, CMItemIndex sampleIndex, CMSampleTimingInfo *timingInfoOut ) = OSStatustoolbox fn CMSampleBufferGetSampleTimingInfoArray( CMSampleBufferRef sbuf, CMItemCount numSampleTimingEntries, CMSampleTimingInfo *timingArrayOut, CMItemCount *timingArrayEntriesNeededOut ) = OSStatustoolbox fn CMSampleBufferGetOutputSampleTimingInfoArray( CMSampleBufferRef sbuf, CMItemCount timingArrayEntries, CMSampleTimingInfo *timingArrayOut, CMItemCount *timingArrayEntriesNeededOut ) = OSStatus// Format descriptiontoolbox fn CMSampleBufferGetFormatDescription( CMSampleBufferRef sbuf ) = CMFormatDescriptionRef// Tag information#if _MACOSMAXALLOWED >= 140000toolbox fn CMSampleBufferGetTaggedBufferGroup( CMSampleBufferRef sbuf ) = CMTaggedBufferGroupRef // macOS 14.0+#endif // 140000// Modify sample bufferstoolbox fn CMSampleBufferGetDataBuffer( CMSampleBufferRef sbuf ) = CMBlockBufferReftoolbox fn CMSampleBufferSetDataBuffer( CMSampleBufferRef sbuf, CMBlockBufferRef dataBuffer ) = OSStatus//toolbox fn CMSampleBufferGetImageBuffer( CMSampleBufferRef sbuf ) = CVImageBufferReftoolbox fn CMSampleBufferGetAudioBufferListWithRetainedBlockBuffer( CMSampleBufferRef sbuf, long *bufferListSizeNeededOut, AudioBufferList *bufferListOut, long bufferListSize, CFAllocatorRef blockBufferStructureAllocator, CFAllocatorRef blockBufferBlockAllocator, UInt32 flags, CMBlockBufferRef *blockBufferOut ) = OSStatustoolbox fn CMSampleBufferSetDataBufferFromAudioBufferList( CMSampleBufferRef sbuf, CFAllocatorRef blockBufferStructureAllocator, CFAllocatorRef blockBufferBlockAllocator, UInt32 flags, AudioBufferList *bufferList ) = OSStatustoolbox fn CMSampleBufferCopyPCMDataIntoAudioBufferList( CMSampleBufferRef sbuf, SInt32 frameOffset, SInt32 numFrames, AudioBufferList *bufferList ) = OSStatustoolbox fn CMSampleBufferGetAudioStreamPacketDescriptions( CMSampleBufferRef sbuf, long packetDescriptionsSize, AudioStreamPacketDescription *packetDescriptionsOut, long *packetDescriptionsSizeNeededOut ) = OSStatustoolbox fn CMSampleBufferGetAudioStreamPacketDescriptionsPtr( CMSampleBufferRef sbuf, AudioStreamPacketDescription **packetDescriptionsPointerOut, long *packetDescriptionsSizeOut ) = OSStatus// Attachmentstoolbox fn CMSampleBufferGetSampleAttachmentsArray( CMSampleBufferRef sbuf, Boolean createIfNecessary ) = CFArrayRef// Process samples/*  handler:  OSStatus (^handler)(CMSampleBufferRef sampleBuffer, CMItemCount index)*/toolbox fn CMSampleBufferCallBlockForEachSample( CMSampleBufferRef sbuf, ptr handler ) = OSStatus/*  handler:  OSStatus (*callback)(CMSampleBufferRef sampleBuffer, CMItemCount index, ptr refcon)*/toolbox fn CMSampleBufferCallForEachSample( CMSampleBufferRef sbuf, ptr handler, ptr refcon ) = OSStatus// Type identifiertoolbox fn CMSampleBufferGetTypeID = CFTypeID